<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Electical Design</title>
    <link rel="icon" type="image/png" href="../cube_cad.png" />
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      /* Custom transition for smooth scrolling */
      html {
        scroll-behavior: smooth;
      }
      .hamburger-menu {
        position: fixed;
        top: 1rem;
        right: 1rem;
        z-index: 50;
        cursor: pointer;
      }
      .menu-overlay {
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.9);
        color: white;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.3s ease;
        z-index: 40;
      }
      .menu-overlay.active {
        opacity: 1;
        pointer-events: auto;
      }
      .menu-overlay a {
        text-decoration: none;
        color: white;
        font-size: 1.5rem;
        margin: 1rem 0;
        transition: color 0.3s ease;
      }
      .menu-overlay a:hover {
        color: gray;
      }
      .image-container {
        position: relative;
        width: 100%;
        max-width: 800px; /* Limit the image size */
        margin: 0 auto; /* Center the image */
      }

      .image-container img {
        width: 100%;
        height: auto;
        display: block;
      }

      .point {
        position: absolute;
        width: 10px;
        height: 10px;
        background-color: red;
        border-radius: 50%;
        cursor: pointer;
        transform: translate(-50%, -50%);
      }

      .popup {
        position: absolute;
        display: none;
        background-color: #fff;
        border: 1px solid #ccc;
        padding: 10px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      }
      .popup::after {
        content: "";
        position: absolute;
        top: 100%;
        left: 50%;
        margin-left: -5px;
        border-width: 5px;
        border-style: solid;
        border-color: #fff transparent transparent transparent;
      }
    </style>
  </head>
  <body class="font-sans">
    <!-- Top-right Home Button -->
    <a href="../index.html" class="absolute top-4 left-4 z-50">
      <p class="text-white text-lg md:text-2xl mt-4">The Cube</p>
      <!-- <img
        src="../images/home.jpg"
        alt="Home"
        class="w-20 h-20 hover:opacity-75 transition-opacity"
      /> -->
    </a>
    <!-- Hamburger Menu -->
    <div id="hamburger" class="hamburger-menu">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        class="h-8 w-8 text-white"
        fill="none"
        viewBox="0 0 24 24"
        stroke="currentColor"
        stroke-width="2"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          d="M4 6h16M4 12h16m-7 6h7"
        />
      </svg>
    </div>

    <!-- Menu Overlay -->
    <div id="menu" class="menu-overlay">
      <a href="../index.html">Home</a>
      <a href="system-overview.html">System Overview</a>
      <a href="our-journey.html">Our Journey</a>
      <a href="bill-of-materials.html">Bill of Materials</a>
      <a href="mechanical-design.html">Mechanical Design</a>
      <a href="firmware-design.html">Firmware Design</a>
      <a href="electrical-design.html">Electical Design</a>
    </div>

    <!-- Header Section with Background Image -->
    <div
      class="relative h-96 bg-cover bg-center"
      style="background-image: url('../images/cube/cube_02.jpeg')"
    >
      <div
        class="absolute inset-0 bg-black bg-opacity-50 flex flex-col items-center justify-center text-center"
      >
        <h1 class="text-white text-4xl font-bold">Electical Design</h1>
      </div>
    </div>

    <!-- Content Section -->
    <div class="py-12 bg-gray-100">
      <div class="container mx-auto px-6 text-center">
        <p class="text-lg">
          Our electrical system consisted of a 12V Nidec brushless servo motor
          driven by a PWM signal generated by an Arduino Nano. The Nidec motors
          had a built-in drive, so no external motor drive circuit such as an
          electronic speed controller (ESC) was required which simplified our
          design. All necessary connections were made on a perforated board
          (perf board), which also supported the Arduino Nano. To obtain
          positional data of the cube, we used an MPU9250 inertial measurement
          unit (IMU), providing both accelerometer and gyroscope readings. The
          IMU was connected to the Arduino Nano through the same perf board.
        </p>
        <p class="my-4"></p>
        <!-- Spacer -->
        <p class="text-lg">
          For power, we employed a 2200 mAh, 12V LiPo battery. This battery was
          linked to the Arduino Nano via the perf board and a switch for
          controlled activation/deactivation. Since the Nano has an onboard
          voltage regulator, even though we were supplying 12V, the regulator
          steps it down to a safe operating voltage of 5V. This allows the
          microcontroller on the Nano and the IMU to function without being
          damaged by the higher input voltage. An XT60 connector facilitated the
          connection of the battery to the system’s power input.
        </p>

        <!-- Image with Caption -->
        <figure class="mt-8">
          <div class="image-container">
            <img
              src="../images/electrical_schematic.png"
              alt="Interactive Map"
              style="width: 100%; max-width: 800px; height: auto"
            />
            <div
              class="point"
              style="top: 87%; left: 45%"
              data-info="2200 mAh, 12V LiPo battery: A rechargeable battery providing a stable 12V supply and sufficient capacity to power the motor, control electronics, and sensors."
            ></div>
            <div
              class="point"
              style="top: 78%; left: 13%"
              data-info="Switch: A manual power control component integrated into the circuit to enable or disable the entire system’s power from the battery.
"
            ></div>
            <div
              class="point"
              style="top: 40%; left: 5%"
              data-info="12V Nidec brushless servo motor: A high-performance motor capable of precise speed and position control when driven by a pulse-width modulated (PWM) signal. It connects to our flywheel via the motor shaft to generate rotational energy that allows our cube to balance."
            ></div>
            <div
              class="point"
              style="top: 40%; left: 30%"
              data-info="Arduino Nano: Microcontroller used for generating PWM signals for the servo motor and processing sensor data from the IMU."
            ></div>
            <div
              class="point"
              style="top: 41%; left: 78%"
              data-info="MPU9250 (IMU): An inertial measurement unit that combines a 3-axis accelerometer, 3-axis gyroscope, and a 3-axis magnetometer, providing real-time orientation, movement, position, and magnetic field data for enhanced system analysis and control feedback."
            ></div>
            <div
              class="point"
              style="top: 87%; left: 24%"
              data-info="XT60 Connector: High-current DC connector used to link the LiPo battery’s output to the system, ensuring a secure power connection."
            ></div>
            <div class="popup" id="popup"></div>
          </div>
          <figcaption class="mt-4 text-sm text-gray-700">
            Figure 1: Electrical schematic showing the connections between
            components.
          </figcaption>
        </figure>

        <p class="my-4"></p>
        <!-- Spacer -->
        <p class="text-lg"></p>
      </div>
    </div>

    <script>
      const hamburger = document.getElementById("hamburger");
      const menu = document.getElementById("menu");

      // Toggle the menu when the hamburger icon is clicked
      hamburger.addEventListener("click", () => {
        menu.classList.toggle("active");
      });

      // Close the menu when a link is clicked
      menu.addEventListener("click", (event) => {
        if (event.target.tagName === "A") {
          menu.classList.remove("active");
        }
      });
      const points = document.querySelectorAll(".point");
      const image = document.querySelector(".image-container img");
      const container = document.querySelector(".image-container");

      const dotPositions = [
        { top: 87, left: 45 },
        { top: 78, left: 13 },
        { top: 40, left: 5 }, // Original percentage positions
        { top: 40, left: 30 },
        { top: 41, left: 78 },
        { top: 87, left: 24 },
        { top: 78, left: 13 },
      ];

      // Function to update dot positions
      function updateDotPositions() {
        const containerRect = container.getBoundingClientRect();

        points.forEach((point, index) => {
          const { top, left } = dotPositions[index];
          point.style.top = `${(top / 100) * containerRect.height}px`;
          point.style.left = `${(left / 100) * containerRect.width}px`;
        });
      }

      // Update positions on load and resize
      window.addEventListener("resize", updateDotPositions);
      window.addEventListener("load", updateDotPositions);

      points.forEach((point) => {
        point.addEventListener("click", (e) => {
          const info = point.getAttribute("data-info");
          popup.style.display = "block";
          popup.textContent = info;

          // Get the bounding rectangle of the image container
          const containerRect = document
            .querySelector(".image-container")
            .getBoundingClientRect();

          // Get the popup dimensions
          const popupWidth = popup.offsetWidth;
          const popupHeight = popup.offsetHeight;

          // Calculate the position, offsetting for the popup dimensions
          popup.style.top = `${
            e.clientY - containerRect.top - popupHeight - 10
          }px`; // Adjust height for arrow
          popup.style.left = `${
            e.clientX - containerRect.left - popupWidth / 2
          }px`; // Center horizontally
        });
      });

      // Hide popup when clicking outside
      document.addEventListener("click", (e) => {
        console.log(e.pageX);
        console.log(e.pageY);

        if (!e.target.classList.contains("point")) {
          popup.style.display = "none";
        }
      });
    </script>
  </body>
</html>
